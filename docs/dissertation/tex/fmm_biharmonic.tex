\chapter{Fast Multipole Method}

Let $w(z)$ be the complex velocity $u(z) + iv(z)$, where $z = x+iy$. Thus $Re(w) = u$ and $Im(w)=v$. Then $w$ satisfies:
\begin{equation}\label{eq:complex} w(z) =  \int_\Gamma \left(\frac{d_1(\xi)}{z - \xi} + \frac{d_2(\xi)}{\overline{z - \xi}} - \frac{d_1(z - \xi)}{\overline{(z - \xi)}^2}\right)~\text{d}s(\xi),\end{equation}
where
\begin{equation}\label{eq:dip}
	d_1(\xi) = \frac{(\sigma_y(\xi) - i\sigma_x(\xi))(n_x(xi) + i n_y(\xi))}{4\pi}, \qquad d_2(\xi) = \frac{\ssigma\cdot\nn}{2\pi i}.
\end{equation}
Write $w = \int_\Gamma (w_1 + w_2 + w_3)~\text{d}s(\xi)$. Substituting \eqref{eq:dip} into \eqref{eq:complex} gives:
\begin{align*}
	w_1  &= \frac{(\sigma_y - i\sigma_x)(n_x + in_y)}{4\pi(z - \xi)}\\
	 &=\frac{(\sigma_y n_x - \sigma_x n_y + i(n_y^2 - n_x^2))\overline{(z - \xi)}}{4\pi | z - \xi|}\\
	 &= \frac{(\sigma_y n_x - \sigma_x n_y + i(n_y^2 - n_x^2))(r_x -ir_y)}{4\pi r^2}\\
	 &= \frac{r_x(\sigma_y n_x - \sigma_x n_y) + r_y(n_y^2 - n_x^2) +i\left(r_x(n_y^2 - n_x^2) - r_y(\sigma_y n_x - \sigma_x n_y)\right)}{4\pi r^2}
\end{align*}

\begin{align*}
	w_2 &= \frac{\ssigma \cdot\nn}{2\pi i \overline{(z - \xi)}}\\
		&= \frac{-i\ssigma\cdot\nn (r_x + i r_y)}{2\pi r^2}\\
		& =\frac{r_y\ssigma\cdot\nn - ir_x\ssigma\cdot\nn}{2\pi r^2} 
\end{align*}

\begin{align*}
	w_3  &= \frac{(\sigma_y - i\sigma_x)(n_x + in_y)}{4\pi\overline{(z - \xi)^2}}\\
		& = \frac{(\sigma_y n_x - \sigma_x n_y + i(n_y^2 - n_x^2))(z - \xi)^2}{4\pi | \overline{(z - \xi)^2}|}\\
		& = \frac{(\sigma_y n_x - \sigma_x n_y + i(n_y^2 - n_x^2))(r_x +i r_y)^2}{4\pi r^4}\\
		& = \frac{(\sigma_y n_x - \sigma_x n_y + i(n_y^2 - n_x^2))(r_x^2 - r_y^2 - 2ir_x r_y)}{4\pi r^4}\\
		& = \frac{(\sigma_y n_x - \sigma_x n_y)(r_x^2 - r_y^2) + 2(n_y^2 - n_x^2)r_x r_y + i((n_y^2 - n_x^2)(r_x^2 - r_y^2)-2r_x r_y(\sigma_y n_x - \sigma_x) n_y)}{4\pi r^4}
\end{align*}

\begin{align*}
	u &= Re\left(\int_\Gamma (w_1 + w_2 + w_3)~\text{d}s(\xi)\right)\\
	 &= \int_\Gamma \left( \frac{r_x(\sigma_y n_x - \sigma_x n_y) - r_y(n_y^2 - n_x^2)}{4\pi r^2} + \frac{r_y\ssigma\cdot\nn}{2\pi r^2} + \frac{(\sigma_y n_x -\sigma_xn_y)(r_x^2 - r_y^2) + 2(n_y^2 - n_x^2)r_x r_y}{4\pi r^4}\right)~\text{d}s(\xi)
\end{align*}